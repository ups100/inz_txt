\chapter{Wprowadzenie}

Komputery oraz inne urządzenia tworzące infrastrukturę informatyczną
przedsiębiorstwa odgrywają bardzo ważną rolę dla procesów biznesowych
firmy. Wiele współczesnych ośrodków badawczych, jak i~firm, nie może
w~ogóle funkcjonować, jeśli zostaną pozbawione swojej
infrastruktury~IT. Znaczna część urządzeń połączona jest ze sobą
tworząc sieć prywatną --- intranet. Do ich połączenia konieczna jest
zarówno rozbudowana struktura okablowania, jak i~zestaw urządzeń
sieciowych. Brak możliwości używania komputera lub komunikacji poprzez
infrastrukturę sieciową niesie ze sobą poważne straty
finansowe. Konieczne jest zatem zapewnienie prawidłowego
funkcjonowania całej infrastruktury, zawsze, gdy jest ona
potrzebna. W~zapewnieniu dostępności usług IT istotne jest ciągłe
monitorowanie ich stanu oraz przewidywanie i~planowanie prac
naprawczych i~konserwacyjnych. Dzięki temu można uniknąć długotrwałych
przerw lub optymalizować ich koszt planując je w~godzinach
najmniejszego zapotrzebowania na usługi. Istotne jest również
wykrywanie z~wyprzedzeniem problemów, gdyż pozwala to podejmować
odpowiednie akcje zaradcze.

Urządzenia elektroniczne posiadają ograniczoną trwałość, dlatego też
istnieje prawdopodobieństwo ich awarii. Ponadto należy pamiętać, iż na
urządzeniach uruchamiane jest oprogramowanie, które może zawierać
błędy. Z~punktu widzenia użytkownika końcowego, za awarię w~danym
systemie należy zatem uznać nie tylko fizyczne uszkodzenie urządzenia,
lecz także sytuację, w~której użytkownik zostaje pozbawiony dostępu do
danej aplikacji czy usługi. Warto również zauważyć, że użytkownik
oczekuje od infrastruktury IT dostarczenia usług o~odpowiednim
poziomie. Zatem należy również uznać za awarię sytuację, gdy usługi
świadczone użytkownikowi nie są na satysfakcjonującym poziomie.

Użytkownik końcowy bardzo często nie jest w~stanie udzielić
precyzyjnej informacji o~usterce, która pojawiła się w~jego
aplikacji. Często ma miejsce sytuacja, w~której użytkownik zgłasza, że
program, z~którego korzysta, nie działa, natomiast faktyczną
przyczyną błędu jest awaria bazy danych lub komunikacji
sieciowej. Indywidualna diagnoza przy każdej awarii jest czasochłonna,
przez co czas do jej usunięcia wydłuża się, powodując straty
finansowe. Konieczne jest zatem monitorowanie stanu urządzeń
składających się na infrastrukturę IT przedsiębiorstwa.

Stan urządzenia informatycznego składa się z~dwóch
elementów. Pierwszym z~nich jest stan usług świadczonych przez to
urządzenie. Przykładami są nie tylko serwery HTTP czy FTP, lecz
również prawidłowe trasowanie pakietów przez router czy filtrowanie
ruchu przez zaporę (ang. {\em firewall}). Sprawdzenie stanu usługi
danego urządzenia zazwyczaj może się w~łatwy sposób odbywać z~innego
urządzenia bez konieczności ingerencji w~przedmiot badań. Drugim
elementem składowym stanu urządzenia są jego parametry
wewnętrzne. Przykładami takich parametrów mogą być: obciążenie
procesora, zużycie pamięci oraz długość kolejek dyskowych. Parametry
urządzenia są zatem jego danymi prywatnymi i~ich uzyskanie z~zewnątrz
jest utrudnione. Do ich pozyskiwania stosuje się zatem specjalne
oprogramowanie, które pozwala na udostępnianie parametrów urządzenia
na zewnątrz. Popularnym narzędziem używanym w~tym celu jest protokół
SNMP (ang. {\em Simple Network Management Protocol})\cite{www:SNMP}.
Protokół ten pozwala na dostęp do drzewiastej struktury (MIB ---
ang. {\em Management Information Base}), która zawiera parametry
urządzenia, jak i~pola sterujące. Poprzez mechanizm pułapek (ang. {\em
  trap}) możliwe jest również zażądanie notyfikacji, gdy jakiś
parametr osiągnie pewną wartość lub wystąpi inne zdarzenie systemowe.

Monitorowanie infrastruktury IT oznacza zatem śledzenie stanów
wszystkich jej urządzeń składowych. Zadaniem systemu monitorującego
jest nie tylko śledzenie stanu urządzeń lecz również przedstawianie go
administratorowi w~sposób zgodny z~jego oczekiwaniami. Można wyróżnić
dwa podstawowe rodzaje monitorowania:

\begin{description}
\item[monitorowanie aktywne] --- rodzaj monitorowania, w~którym system
  monitorujący cyklicznie wykonuje sprawdzenie stanu danego
  urządzenia lub usługi (ang. {\em polling}),
\item[monitorowanie pasywne] --- rodzaj monitorowania, w~którym status
  usługi lub urządzenia zgłaszany jest (być może w~nieregularnych
  odstępach) przez program zewnętrzny do systemu monitorującego.
\end{description}

Każdy ze~sposobów monitorowania posiada zarówno swoje wady, jak
i~zalety. Wybór metody monitorowania zależy zatem od charakterystyki
monitorowanego parametru lub usługi. Jeśli podlega on nieregularnym
i~krótkotrwałym zmianom, a~każda z~nich powinna być odnotowana,
stosuje się monitorowanie pasywne. Klasycznym przykładem zastosowania
monitorowania pasywnego jest oczekiwanie na pojawienie się pułapki
protokołu SNMP. Nigdy nie wiadomo, kiedy ani ile notyfikacji
nadejdzie. Natomiast jeśli dana wartość posiada charakterystykę
zmieniającą się w~sposób ciągły, należy korzystać wtedy
z~monitorowania aktywnego, które dokonuje próbkowania danej wartości
w~określonych odstępach czasu.

Sieci bardzo dużych przedsiębiorstw posiadają budowę
wielosegmentową. Ze względów bezpieczeństwa bardzo często składa się
ona z~sieci wirtualnych, czy wręcz fizycznie odizolowanych od siebie
podsieci. Ponadto sieci przedsiębiorstwa bardzo często zawierają
zapory ogniowe, które filtrują ruch pomiędzy jej segmentami. Ze
względu na fragmentację konieczne jest użycie systemu w architekturze
rozproszonej.

Najprostszą realizacją rozproszonego systemu monitorowania jest użycie
monitorowania pasywnego do monitorowania wszystkich urządzeń i~usług,
które nie są widoczne z~sieci, w~której uruchomiony jest system
monitorujący. Niestety może to wymagać zmian w~konfiguracji wszystkich
urządzeń i~uruchomienia na nich dodatkowego oprogramowania. Takie
zmiany mogą nie być dozwolone na prostych urządzeniach, których
kontrola odbywa się poprzez preinstalowany system producenta.

Możliwa jest również konfiguracja wieloinstancyjnego systemu
monitorowania. W~każdej odizolowanej komórce sieci należy umieścić
instancję systemu, która będzie zbierała dane z~tej komórki
sieci. Monitorowanie danego fragmentu infrastruktury może się odbywać
zarówno w~sposób aktywny, jak i~pasywny. Po wstępnym przetworzeniu
takich danych muszą one zostać zsynchronizowane pomiędzy instancjami,
a~następnie umieszczone w~instancji nadrzędnej lub innym zbiorczym
miejscu docelowym. Rozwiązanie to posiada liczne zalety i~jest bardzo
często stosowane. Dodatkowo niektóre z~systemów (np. Icinga)
umożliwiają wymianę danych pomiędzy instancjami bez konieczności
istnienia wyróżnionej instancji nadrzędnej.

Niezależnie od przyjętej architektury monitorowania, samo
przedstawienie administratorowi danych bieżących jest często
niewystarczające. Precyzyjna diagnoza awarii w~możliwe krótkim czasie
od jej wystąpienia jest bardzo ważna. Jednak istotna jest również
możliwość analizy danych historycznych awarii, aby umożliwić wykrycie
potencjalnie krytyczniejszej awarii jeszcze przed jej
wystąpieniem. Dostępne są na rynku systemy monitorujące, które
pozwalają na gromadzenie informacji w~bazach danych. Kolejnym krokiem
może być wówczas analiza takiej bazy z~wykorzystaniem systemu
eksperckiego, który wykaże odpowiednie zależności i~na tej podstawie
umożliwi wykrycie potencjalnej awarii jeszcze przed jej wystąpieniem.

Współczesne korporacje posiadają nie tylko rozbudowaną infrastrukturę
sieciową, lecz również bardzo dużą liczbę urządzeń mobilnych, takich
jak laptopy, tablety czy inne urządzenia specyficzne dla danej
firmy. Wraz z upowszechnieniem się rozwiązań chmurowych i
wirtualizacji stacji roboczych popularność zyskuje idea BYOD
(ang. Bring Your Own Device). Bardzo często okazuje się, że poprawne
działanie tych urządzeń wpływa znacząco na efektywność pracy osób,
które ich używają. Monitorowanie takiego urządzenie jest zadaniem
nietrywialnym. Należy pamiętać, iż urządzenie mobilne może nie mieć
chwilowej możliwości komunikacji z~systemem monitorującym. Jeśli
przerwy w~łączności występują stosunkowo często, to w~przypadku braku
późniejszej synchronizacji danych można doprowadzić do fałszywych
predykcji systemu eksperckiego. Aby tego uniknąć, konieczne jest
lokalne buforowanie danych podlegających analizie i~ich dostarczenie,
kiedy tylko stanie się to możliwe. W~przypadku klienta mobilnego
niezwykle istotna jest również kwestia bezpieczeństwa. Urządzenia
takie często nie pracują wewnątrz sieci firmowej, lecz używają do
komunikacji wielu różnych, niezaufanych sieci. Dane zebrane podczas
monitorowania klienta mobilnego mogą zawierać tajemnice handlowe firmy
(np. adresację wewnętrzną, nazwy zasobów sieciowych). Konieczne jest
zatem zapewnienie zarówno poufności, jak i~integralności danych
podczas synchronizacji.

W~chwili pisania tej pracy, nie udało się odnaleźć na rynku systemu,
który umożliwiałby monitorowanie klienta mobilnego zarówno wśród
systemów bezpłatnych jak i~komercyjnych. Ważne jest dostarczenie
odpowiedniego systemu, który pozwoli na kompleksowe monitorowanie
wszystkich urządzeń występujących w~firmie, zarówno mobilnych, jak
i~statycznych. W~związku z~powyższym w~niniejszej pracy wykonano
rozbudowę popularnego systemu monitorowania Icinga, aby umożliwić
monitorowanie przy jego użyciu obu typów urządzeń. W~ramach pracy
zaproponowany został protokół komunikacyjny pozwalający na przekazanie
danych z~urządzenia mobilnego do systemu monitorującego. Ponadto
opracowano i~zaimplementowano dodatek do systemu Icinga pozwalający na
dostarczenie danych do systemu monitorującego używając zaproponowanego
protokołu. Praca ta jest częścią systemu monitorowania urządzeń
mobilnych opracowywanego na Wydziale Elektroniki i~Technik
Informacyjnych. Istotnym etapem tej pracy było również utworzenie
zaproponowanego systemu monitorowania w~środowisku testowym. Ważnym
elementem składowym tego systemu jest również praca inżynierska Pana
Marcina Kubika\cite{book:pracaKubika}, w~której zawarto opis
implementacji aplikacji monitorującej przeznaczonej dla platformy
Android. Aplikacja ta wykorzystuje opracowany w~ramach niniejszej
pracy protokół i~dodatek do rejestrowania w~systemie Icinga zbieranych
danych o~monitorowanym urządzeniu mobilnym. Na podstawie danych
pochodzących z~kilkutygodniowego okresu testowego użytkowania systemu
potwierdzono konieczność monitorowania zarówno urządzeń stacjonarnych,
jak i~mobilnych. Podczas testów wykorzystana została też wcześniej
wspomniana aplikacja opracowana przez Pana Kubika.

Układ pracy jest następujący. Rozdział~\ref{chap:Systemy} zawiera opis
oraz porównanie kilku wybranych systemów monitorowania o~otwartym
kodzie. W~rozdziale \ref{chap:Wymagania} przedstawiono problematykę
monitorowania klienta statycznego oraz mobilnego. Ponadto po wykonaniu
analizy, przedstawiono wymagania, jakie są stawiane przed systemem
kompleksowego monitorowania przedsiębiorstwa. Rozdział
\ref{chap:Icinga} zawiera opis systemu Icinga, na bazie którego
budowany jest projektowany system. W~rozdziale
\ref{chap:ProjektSystemu} przedstawiono projekt systemu monitorowania
oraz opis protokołu komunikacyjnego. Rozdział \ref{chap:Implementacja}
zawiera opis wykonanej w~ramach niniejszej pracy implementacji dodatku
pozwalającego na przekazanie danych o~stanie urządzenia pochodzących
z~monitorowanego urządzenia mobilnego do systemu Icinga. W~rozdziale
\ref{chap:Testy} znajduje się opis konfiguracji testowej wykonanego
systemu, a~także sprawozdanie z~jego użytkowania. Podsumowanie
niniejszej pracy zawarto w~rozdz.~\ref{chap:Podsumowanie}, w~którym
wskazano również potencjalne możliwości rozwoju wykonanego systemu.
